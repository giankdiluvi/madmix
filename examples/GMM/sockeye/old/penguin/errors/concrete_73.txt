Traceback (most recent call last):
  File "gmm_run_concrete_penguin.py", line 106, in <module>
    tmp_flow,tmp_loss=trainGMMRealNVP(
  File "/arc/project/st-tdjc-1/madmix/examples/gmm/penguin/../../../src/concrete.py", line 704, in trainGMMRealNVP
    loss = -flow.log_prob(sample).mean()
  File "/arc/project/st-tdjc-1/madmix/examples/gmm/penguin/../../../src/concrete.py", line 406, in log_prob
    return self.prior.log_prob(z) + logp
  File "/arc/project/st-tdjc-1/madmix/examples/gmm/penguin/../../../src/concrete.py", line 558, in log_prob
    xc_lp += self.invwis.log_prob(torch.moveaxis(Sigmas[k,...],2,0))
  File "/home/giank/.local/lib/python3.8/site-packages/torch/distributions/wishart.py", line 271, in log_prob
    self._validate_sample(value)
  File "/home/giank/.local/lib/python3.8/site-packages/torch/distributions/distribution.py", line 300, in _validate_sample
    raise ValueError(
ValueError: Expected value argument (Tensor of shape (1000, 4, 4)) to be within the support (PositiveDefinite()) of the distribution Wishart(covariance_matrix: torch.Size([4, 4]), df: 111.0), but found invalid values:
tensor([[[ 5.9085e-14, -9.1561e-07,  1.6031e-06, -4.1658e-07],
         [-9.1561e-07,  1.5564e+01, -2.2724e+01,  8.5109e+00],
         [ 1.6031e-06, -2.2724e+01,  4.6756e+01, -8.1210e+00],
         [-4.1658e-07,  8.5109e+00, -8.1210e+00,  1.0836e+01]],

        [[ 4.6566e-08, -1.2899e-04,  6.3611e-04, -5.8476e-04],
         [-1.2899e-04,  3.1121e+00,  1.3052e+01,  1.0613e+01],
         [ 6.3611e-04,  1.3052e+01,  8.8355e+01,  4.0468e+01],
         [-5.8476e-04,  1.0613e+01,  4.0468e+01,  8.8175e+01]],

        [[ 1.8854e-04, -7.3148e-03, -9.6174e-02, -4.5635e-02],
         [-7.3148e-03,  5.0122e+01,  3.1117e+01,  7.7717e+01],
         [-9.6174e-02,  3.1117e+01,  6.4133e+01,  6.6227e+01],
         [-4.5635e-02,  7.7717e+01,  6.6227e+01,  2.0258e+02]],

        ...,

        [[ 3.8091e-05, -1.2612e-02, -2.5354e-02, -2.1341e-02],
         [-1.2612e-02,  1.1171e+01,  2.9697e+01,  1.2451e+01],
         [-2.5354e-02,  2.9697e+01,  8.1751e+01,  3.0612e+01],
         [-2.1341e-02,  1.2451e+01,  3.0612e+01,  2.1663e+01]],

        [[ 7.0882e-14, -2.7283e-07, -4.4466e-07, -1.8144e-07],
         [-2.7283e-07,  6.7481e+01,  1.6653e+01,  2.4509e+01],
         [-4.4466e-07,  1.6653e+01,  6.7618e+00,  9.5946e+00],
         [-1.8144e-07,  2.4509e+01,  9.5946e+00,  3.1465e+01]],

        [[ 1.7516e-32, -8.8096e-17,  3.2054e-17,  2.4337e-17],
         [-8.8096e-17,  3.9611e+01,  2.2790e+01,  2.2258e+01],
         [ 3.2054e-17,  2.2790e+01,  1.3551e+01,  1.3926e+01],
         [ 2.4337e-17,  2.2258e+01,  1.3926e+01,  3.4435e+01]]],
       grad_fn=<PermuteBackward0>)
