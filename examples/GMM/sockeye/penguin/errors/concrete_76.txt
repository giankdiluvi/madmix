Traceback (most recent call last):
  File "gmm_run_concrete_penguin.py", line 106, in <module>
    tmp_flow,tmp_loss=trainGMMRealNVP(
  File "/arc/project/st-tdjc-1/madmix/examples/gmm/penguin/../../../src/concrete.py", line 704, in trainGMMRealNVP
    loss = -flow.log_prob(sample).mean()
  File "/arc/project/st-tdjc-1/madmix/examples/gmm/penguin/../../../src/concrete.py", line 406, in log_prob
    return self.prior.log_prob(z) + logp
  File "/arc/project/st-tdjc-1/madmix/examples/gmm/penguin/../../../src/concrete.py", line 558, in log_prob
    xc_lp += self.invwis.log_prob(torch.moveaxis(Sigmas[k,...],2,0))
  File "/home/giank/.local/lib/python3.8/site-packages/torch/distributions/wishart.py", line 271, in log_prob
    self._validate_sample(value)
  File "/home/giank/.local/lib/python3.8/site-packages/torch/distributions/distribution.py", line 300, in _validate_sample
    raise ValueError(
ValueError: Expected value argument (Tensor of shape (1000, 4, 4)) to be within the support (PositiveDefinite()) of the distribution Wishart(covariance_matrix: torch.Size([4, 4]), df: 111.0), but found invalid values:
tensor([[[ 1.5375,  0.1378,  0.2025,  3.1247],
         [ 0.1378,  0.5724,  1.9424,  0.5051],
         [ 0.2025,  1.9424,  6.8556,  0.5990],
         [ 3.1247,  0.5051,  0.5990,  8.0531]],

        [[ 4.8953, -0.6356,  0.6745,  2.3814],
         [-0.6356,  0.4409, -0.0836,  0.1690],
         [ 0.6745, -0.0836,  0.4636,  0.6488],
         [ 2.3814,  0.1690,  0.6488,  2.3963]],

        [[ 0.5800,  0.1557,  0.1579,  1.5487],
         [ 0.1557,  0.5738,  0.2793,  0.5200],
         [ 0.1579,  0.2793,  0.3616,  0.3891],
         [ 1.5487,  0.5200,  0.3891,  4.2445]],

        ...,

        [[ 6.4482, -0.1243, -0.7102,  3.9752],
         [-0.1243,  0.1893,  0.8756, -0.2997],
         [-0.7102,  0.8756,  4.1631, -1.5802],
         [ 3.9752, -0.2997, -1.5802,  2.8716]],

        [[12.5866, -0.5736,  1.2954,  4.3039],
         [-0.5736,  0.2780,  1.0655,  0.8039],
         [ 1.2954,  1.0655,  5.3598,  4.9382],
         [ 4.3039,  0.8039,  4.9382,  5.5861]],

        [[ 1.7273,  0.1594,  0.1426,  1.4305],
         [ 0.1594,  0.6767,  1.2042, -0.1939],
         [ 0.1426,  1.2042,  2.1937, -0.5583],
         [ 1.4305, -0.1939, -0.5583,  1.5725]]], grad_fn=<PermuteBackward0>)
