Traceback (most recent call last):
  File "gmm_run_dequant_penguin.py", line 97, in <module>
    tmp_flow,tmp_loss=dequantization.train_dequant_gmm(
  File "/arc/project/st-tdjc-1/madmix/examples/gmm/dequantization/penguin/dequantization.py", line 280, in train_dequant_gmm
    loss = -flow.log_prob(sample).mean()
  File "/arc/project/st-tdjc-1/madmix/examples/gmm/dequantization/penguin/concrete.py", line 406, in log_prob
    return self.prior.log_prob(z) + logp
  File "/arc/project/st-tdjc-1/madmix/examples/gmm/dequantization/penguin/dequantization.py", line 141, in log_prob
    xc_lp += self.invwis.log_prob(torch.moveaxis(Sigmas[k,...],2,0))
  File "/home/giank/.local/lib/python3.8/site-packages/torch/distributions/wishart.py", line 271, in log_prob
    self._validate_sample(value)
  File "/home/giank/.local/lib/python3.8/site-packages/torch/distributions/distribution.py", line 300, in _validate_sample
    raise ValueError(
ValueError: Expected value argument (Tensor of shape (1000, 4, 4)) to be within the support (PositiveDefinite()) of the distribution Wishart(covariance_matrix: torch.Size([4, 4]), df: 111.0), but found invalid values:
tensor([[[ 1.3742e-02,  1.4177e-02,  2.3762e-01,  4.7691e-02],
         [ 1.4177e-02,  1.3199e-01,  8.7443e-02,  4.7850e-02],
         [ 2.3762e-01,  8.7443e-02,  5.7289e+00, -3.2504e-01],
         [ 4.7691e-02,  4.7850e-02, -3.2504e-01,  1.1071e+00]],

        [[ 9.3934e-03,  2.4543e-02,  2.0558e-01,  5.1009e-02],
         [ 2.4543e-02,  3.2510e-01,  3.1852e-01,  1.6474e-01],
         [ 2.0558e-01,  3.1852e-01,  4.9238e+00,  5.5889e-01],
         [ 5.1009e-02,  1.6474e-01,  5.5889e-01,  1.4497e+00]],

        [[ 3.5630e-03,  1.0775e-02,  1.2124e-01,  1.8674e-02],
         [ 1.0775e-02,  7.3559e-02,  3.3138e-01,  1.3076e-01],
         [ 1.2124e-01,  3.3138e-01,  4.4048e+00,  8.4222e-02],
         [ 1.8674e-02,  1.3076e-01,  8.4222e-02,  1.1874e+00]],

        ...,

        [[ 3.5787e-02,  1.9820e-02,  3.1974e-01,  1.1735e-01],
         [ 1.9820e-02,  5.2521e-02,  1.4735e-01,  9.1541e-02],
         [ 3.1974e-01,  1.4735e-01,  4.4333e+00, -2.8019e-02],
         [ 1.1735e-01,  9.1541e-02, -2.8019e-02,  1.1209e+00]],

        [[ 7.2497e-02,  4.0240e-02,  8.1254e-01,  1.6698e-01],
         [ 4.0240e-02,  1.1888e-01,  3.4663e-01,  8.9647e-02],
         [ 8.1254e-01,  3.4663e-01,  1.0666e+01,  6.5534e-01],
         [ 1.6698e-01,  8.9647e-02,  6.5534e-01,  1.4133e+00]],

        [[ 2.2242e-01,  7.3671e-02,  9.4603e-01,  2.2558e-01],
         [ 7.3671e-02,  3.8929e-01,  5.3263e-02,  4.2234e-01],
         [ 9.4603e-01,  5.3263e-02,  4.7145e+00, -5.7579e-02],
         [ 2.2558e-01,  4.2234e-01, -5.7579e-02,  1.7312e+00]]],
       grad_fn=<PermuteBackward0>)
